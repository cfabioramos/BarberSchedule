{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\desenvolvimento\\\\BarberSchedule\\\\App\\\\src\\\\screens\\\\Favorites\\\\index.js\";\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect, useContext } from \"react\";\nimport RefreshControl from \"react-native-web/dist/exports/RefreshControl\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport * as Location from \"expo-location\";\nimport Api from \"../../Api\";\nimport BackIcon from \"../../assets/back.svg\";\nimport BarberItem from \"../../components/BarberItem\";\nimport ModalErro from \"../../components/ModalErro\";\nimport { UserContext } from \"../../contexts/UserContext\";\nimport { Container, Scroller, HeaderArea, HeaderTitle, LoadingIcon, ListArea, BackButton } from \"./styles\";\nexport default (function () {\n  var navigation = useNavigation();\n\n  var _useState = useState({}),\n      _useState2 = _slicedToArray(_useState, 2),\n      addressSearchObject = _useState2[0],\n      setAddressSearchObject = _useState2[1];\n\n  var _useState3 = useState({\n    isModalVisible: false,\n    errorMessage: \"\",\n    cb: setModalAttributes\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      modalAttributes = _useState4[0],\n      setModalAttributes = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      loading = _useState6[0],\n      setLoading = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      list = _useState8[0],\n      setList = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      refreshing = _useState10[0],\n      setRefreshing = _useState10[1];\n\n  var _useContext = useContext(UserContext),\n      user = _useContext.state;\n\n  var getFavoriteBarbers = function getFavoriteBarbers() {\n    var newAddressObj, res;\n    return _regeneratorRuntime.async(function getFavoriteBarbers$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            setLoading(true);\n            setList([]);\n            newAddressObj = null;\n            _context2.next = 5;\n            return _regeneratorRuntime.awrap(function _callee() {\n              var _await$Location$reque, status, location;\n\n              return _regeneratorRuntime.async(function _callee$(_context) {\n                while (1) {\n                  switch (_context.prev = _context.next) {\n                    case 0:\n                      _context.next = 2;\n                      return _regeneratorRuntime.awrap(Location.requestPermissionsAsync());\n\n                    case 2:\n                      _await$Location$reque = _context.sent;\n                      status = _await$Location$reque.status;\n\n                      if (!(status !== \"granted\")) {\n                        _context.next = 7;\n                        break;\n                      }\n\n                      setErrorMsg(\"Permission to access location was denied\");\n                      return _context.abrupt(\"return\");\n\n                    case 7:\n                      _context.next = 9;\n                      return _regeneratorRuntime.awrap(Location.getCurrentPositionAsync({\n                        accuracy: Location.Accuracy.Highest\n                      }));\n\n                    case 9:\n                      location = _context.sent;\n                      newAddressObj = {\n                        latitude: location.coords.latitude,\n                        longitude: location.coords.longitude\n                      };\n                      setAddressSearchObject(_objectSpread(_objectSpread({}, addressSearchObject), newAddressObj));\n\n                    case 12:\n                    case \"end\":\n                      return _context.stop();\n                  }\n                }\n              }, null, null, null, Promise);\n            }());\n\n          case 5:\n            _context2.prev = 5;\n            _context2.next = 8;\n            return _regeneratorRuntime.awrap(Api.getFavoriteBarbers(user.id, newAddressObj));\n\n          case 8:\n            res = _context2.sent;\n            setList(res);\n            setLoading(false);\n            _context2.next = 17;\n            break;\n\n          case 13:\n            _context2.prev = 13;\n            _context2.t0 = _context2[\"catch\"](5);\n            setLoading(false);\n            setModalAttributes({\n              isModalVisible: true,\n              errorMessage: _context2.t0.message,\n              cb: setModalAttributes\n            });\n\n          case 17:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[5, 13]], Promise);\n  };\n\n  useEffect(function () {\n    var unsubscribe = navigation.addListener('focus', function () {\n      getFavoriteBarbers();\n    });\n    return unsubscribe;\n  }, [navigation]);\n\n  var handleBackButton = function handleBackButton() {\n    navigation.goBack();\n  };\n\n  var onRefresh = function onRefresh() {\n    setRefreshing(false);\n    getFavoriteBarbers();\n  };\n\n  return React.createElement(Container, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 5\n    }\n  }, React.createElement(ModalErro, {\n    controlObject: modalAttributes,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }\n  }), React.createElement(Scroller, {\n    refreshControl: React.createElement(RefreshControl, {\n      refreshing: refreshing,\n      onRefresh: onRefresh,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }\n    }),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }\n  }, React.createElement(HeaderArea, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }\n  }, React.createElement(BackButton, {\n    onPress: handleBackButton,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }\n  }, React.createElement(BackIcon, {\n    width: \"35\",\n    height: \"35\",\n    fill: \"#FFFFFF\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }\n  })), React.createElement(HeaderTitle, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 11\n    }\n  }, \"Favoritos\")), loading && React.createElement(LoadingIcon, {\n    size: \"large\",\n    color: \"#FFFFFF\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 21\n    }\n  }), React.createElement(ListArea, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }\n  }, list.map(function (item, k) {\n    return React.createElement(BarberItem, {\n      key: k,\n      data: item,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 13\n      }\n    });\n  }))));\n});","map":{"version":3,"sources":["C:/desenvolvimento/BarberSchedule/App/src/screens/Favorites/index.js"],"names":["React","useState","useEffect","useContext","useNavigation","Location","Api","BackIcon","BarberItem","ModalErro","UserContext","Container","Scroller","HeaderArea","HeaderTitle","LoadingIcon","ListArea","BackButton","navigation","addressSearchObject","setAddressSearchObject","isModalVisible","errorMessage","cb","setModalAttributes","modalAttributes","loading","setLoading","list","setList","refreshing","setRefreshing","user","state","getFavoriteBarbers","newAddressObj","requestPermissionsAsync","status","setErrorMsg","getCurrentPositionAsync","accuracy","Accuracy","Highest","location","latitude","coords","longitude","id","res","message","unsubscribe","addListener","handleBackButton","goBack","onRefresh","map","item","k"],"mappings":"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","sourcesContent":["import React, { useState, useEffect,useContext } from \"react\";\r\nimport { RefreshControl } from \"react-native\";\r\nimport { useNavigation } from \"@react-navigation/native\";\r\nimport * as Location from \"expo-location\";\r\nimport Api from \"../../Api\";\r\nimport BackIcon from \"../../assets/back.svg\";\r\nimport BarberItem from \"../../components/BarberItem\";\r\nimport ModalErro from \"../../components/ModalErro\";\r\nimport { UserContext } from \"../../contexts/UserContext\";\r\n\r\nimport {\r\n  Container,\r\n  Scroller,\r\n  HeaderArea,\r\n  HeaderTitle,\r\n  LoadingIcon,\r\n  ListArea,\r\n  BackButton,\r\n} from \"./styles\";\r\n\r\nexport default () => {\r\n  const navigation = useNavigation();\r\n  const [addressSearchObject, setAddressSearchObject] = useState({});\r\n  const [modalAttributes, setModalAttributes] = useState({\r\n    isModalVisible: false,\r\n    errorMessage: \"\",\r\n    cb: setModalAttributes,\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const [list, setList] = useState([]);\r\n  const [refreshing, setRefreshing] = useState(false);\r\n\r\n  const { state: user } = useContext(UserContext);\r\n\r\n  const getFavoriteBarbers = async () => {\r\n    setLoading(true);\r\n    setList([]);\r\n    let newAddressObj = null\r\n    await (async () => {\r\n      let { status } = await Location.requestPermissionsAsync();\r\n      if (status !== \"granted\") {\r\n        setErrorMsg(\"Permission to access location was denied\");\r\n        return;\r\n      }\r\n      let location = await Location.getCurrentPositionAsync({\r\n        accuracy: Location.Accuracy.Highest,\r\n      });\r\n      newAddressObj = {\r\n        latitude: location.coords.latitude,\r\n        longitude: location.coords.longitude\r\n      }\r\n      setAddressSearchObject({\r\n        ...addressSearchObject,\r\n        ...newAddressObj,\r\n      });\r\n    })();\r\n    try {\r\n      let res = await Api.getFavoriteBarbers(user.id, newAddressObj);\r\n      setList(res);\r\n      setLoading(false);\r\n    } catch (error) {\r\n      setLoading(false);\r\n      setModalAttributes({\r\n        isModalVisible: true,\r\n        errorMessage: error.message,\r\n        cb: setModalAttributes,\r\n      });\r\n    }\r\n  };\r\n  \r\n  useEffect(() => {\r\n    const unsubscribe = navigation.addListener('focus', () => {\r\n      getFavoriteBarbers();\r\n    });\r\n    return unsubscribe;\r\n  }, [navigation]);\r\n\r\n  const handleBackButton = () => {\r\n    navigation.goBack();\r\n  };\r\n\r\n  const onRefresh = () => {\r\n    setRefreshing(false);\r\n    getFavoriteBarbers();\r\n  };\r\n\r\n  return (\r\n    <Container>\r\n      <ModalErro controlObject={modalAttributes} />\r\n      <Scroller\r\n        refreshControl={\r\n          <RefreshControl refreshing={refreshing} onRefresh={onRefresh} />\r\n        }\r\n      >\r\n        <HeaderArea>\r\n          <BackButton onPress={handleBackButton}>\r\n            <BackIcon width=\"35\" height=\"35\" fill=\"#FFFFFF\" />\r\n          </BackButton>\r\n          <HeaderTitle>Favoritos</HeaderTitle>\r\n        </HeaderArea>\r\n\r\n        {loading && <LoadingIcon size=\"large\" color=\"#FFFFFF\" />}\r\n\r\n        <ListArea>\r\n          {list.map((item, k) => (\r\n            <BarberItem key={k} data={item} />\r\n          ))}\r\n        </ListArea>\r\n      </Scroller>\r\n    </Container>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}